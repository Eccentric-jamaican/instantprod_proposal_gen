<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Proposal</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap"
    rel="stylesheet">
  <style>
    :root {
      --bg: #0b0908;
      /* Dark base */
      --bg-secondary: linear-gradient(135deg, #1a0f14 0%, #120816 50%, #0a080c 100%);
      /* subtle purple/ink gradient */
      --text: #f5f1ea;
      /* Soft white/cream */
      --muted: #e2d9cb;
      /* Muted copy (higher contrast on dark) */
      --accent: #f5e6c9;
      /* Warm accent (CTA / highlight) */
      --border: #2a2420;
      /* Soft border */
      --serif: 'Playfair Display', serif;
      --sans: 'Inter', sans-serif;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: var(--sans);
      padding: 40px 28px;
      line-height: 1.5;
    }

    .page {
      max-width: 920px;
      margin: 0 auto;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      box-shadow: 0 14px 52px rgba(0, 0, 0, 0.45);
      padding: 20px 22px 52px;
      border-radius: 14px;
    }

    /* HEADER / COVER */
    header {
      margin-bottom: 48px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .topbar {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      padding: 8px 0 4px;
      border-bottom: 1px solid var(--border);
    }

    .logo img {
      height: 44px;
      width: auto;
      display: block;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.35));
    }

    .title-block {
      display: flex;
      flex-direction: column;
      gap: 10px;
      align-items: flex-start;
      margin-top: 8px;
    }

    h1 {
      font-family: var(--serif);
      font-size: 72px;
      font-weight: 400;
      line-height: 1.08;
      letter-spacing: -0.03em;
      margin: 0;
      padding: 12px 0;
      display: inline-block;
      background: transparent;
      border: none;
      box-shadow: none;
    }

    .subtitle {
      font-size: 20px;
      font-weight: 300;
      display: inline-block;
      padding: 4px 0;
      margin: 0;
      line-height: 1.4;
      background: transparent;
      border: none;
      box-shadow: none;
    }

    .meta {
      font-size: 10px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--muted);
      display: inline-block;
      line-height: 1.2;
      margin: 0;
      padding: 0;
      justify-self: end;
      text-align: right;
    }

    .meta-strip {
      display: block;
      margin-top: 10px;
      padding-top: 6px;
      border-top: 1px solid var(--border);
      letter-spacing: 0.08em;
      text-align: left;
      opacity: 0.9;
    }

    .hero-img {
      width: calc(100% + 44px);
      margin: 0 -22px 72px;
      height: 320px;
      background: #140c0f;
      background-image: linear-gradient(180deg, rgba(40, 22, 32, 0.55) 0%, rgba(22, 12, 20, 0.8) 100%), url('./hero_image.jpg');
      background-size: cover;
      background-position: center;
      border-radius: 0;
      border: none;
    }

    /* SECTIONS */
    section {
      margin-bottom: 72px;
    }

    h2 {
      font-family: var(--serif);
      font-size: 64px;
      margin-bottom: 40px;
      line-height: 1;
    }

    h2 strong {
      text-transform: uppercase;
    }

    /* GRID LAYOUTS (01, 02...) */
    .grid-2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 32px;
      align-items: start;
    }

    .item {
      margin-bottom: 24px;
      display: flex;
      flex-direction: column;
    }

    .num {
      font-family: var(--serif);
      font-size: 48px;
      margin-bottom: 12px;
      display: block;
      line-height: 1;
    }

    .desc {
      font-size: 16px;
      line-height: 1.6;
      word-wrap: break-word;
      overflow-wrap: break-word;
    }

    mark {
      background: var(--accent);
      color: #0f0a09;
      padding: 0 4px;
    }

    /* PROBLEM SECTION */
    .problem-section {
      position: relative;
    }

    .problem-intro {
      max-width: 640px;
      margin-bottom: 18px;
      font-size: 18px;
      line-height: 1.7;
    }

    .problem-divider {
      width: 120px;
      height: 2px;
      background: rgba(245, 230, 201, 0.45);
      margin: 0 0 36px;
    }

    .problem-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 36px 32px;
    }

    .problem-card {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .problem-num {
      font-family: var(--serif);
      font-size: 42px;
      line-height: 1;
    }

    .problem-body {
      font-size: 15px;
      line-height: 1.7;
      margin-top: 6px;
      background: transparent;
      border-radius: 0;
      padding: 0;
      border: none;
      box-shadow: none;
    }

    /* SOLUTION SECTION */
    .solution-section {
      position: relative;
    }

    .solution-summary {
      max-width: 640px;
      margin-bottom: 18px;
      font-size: 18px;
      line-height: 1.7;
    }

    .solution-context {
      max-width: 640px;
      font-size: 17px;
      line-height: 1.7;
      color: var(--muted);
      margin-bottom: 24px;
    }

    .solution-context span {
      color: var(--text);
      font-weight: 600;
    }

    .solution-divider {
      width: 120px;
      height: 2px;
      background: rgba(245, 230, 201, 0.45);
      margin: 0 0 36px;
    }

    .solution-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 36px 32px;
    }

    .solution-card {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .solution-card .num {
      margin-bottom: 0;
    }

    .solution-card p {
      font-size: 15px;
      line-height: 1.7;
      margin-top: 6px;
      background: transparent;
      border-radius: 0;
      padding: 0;
      border: none;
      box-shadow: none;
    }

    .solution-meta {
      margin-top: 42px;
      display: inline-flex;
      align-items: center;
      gap: 12px;
      font-size: 14px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--muted);
    }

    .solution-meta span:last-child {
      background: rgba(245, 230, 201, 0.18);
      color: var(--text);
      padding: 6px 12px;
      border-radius: 8px;
      letter-spacing: 0.04em;
      font-weight: 600;
    }

    .how-intro {
      max-width: 640px;
      font-size: 17px;
      line-height: 1.7;
      color: var(--muted);
      margin-bottom: 40px;
    }

    /* WHY US SECTION */
    .why-container {
      display: flex;
      flex-direction: row;
      align-items: flex-start;
      gap: 32px;
    }

    .why-text {
      flex: 2;
    }

    .black-card {
      padding: 0 0 20px;
      margin-bottom: 16px;
      background: transparent;
      border-radius: 0;
    }

    .black-card h3 {
      font-family: var(--serif);
      font-size: 22px;
      margin-bottom: 6px;
      line-height: 1.3;
    }

    .black-card p {
      font-size: 15px;
      opacity: 0.9;
      line-height: 1.6;
      margin: 0;
    }

    .why-matters {
      margin-top: 40px;
    }

    .why-matters-heading {
      font-family: var(--serif);
      font-size: 28px;
      margin-bottom: 18px;
    }

    .why-matters-list {
      display: flex;
      flex-direction: column;
      gap: 16px;
      max-width: 760px;
    }

    .why-matters-item {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 18px;
      align-items: flex-start;
      font-size: 15px;
      line-height: 1.7;
    }

    .why-matters-num {
      font-family: var(--serif);
      font-size: 22px;
      line-height: 1;
    }

    .why-matters-body {
      margin: 0;
    }

    .why-matters-meta {
      margin-top: 10px;
      font-size: 14px;
      line-height: 1.6;
      color: var(--muted);
    }

    /* PROCESS TABLE */
    .process-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 24px;
    }

    .process-table th {
      background: rgba(0, 0, 0, 0.75);
      color: var(--text);
      text-align: left;
      padding: 16px 16px;
      text-transform: uppercase;
      font-size: 11px;
      letter-spacing: 0.05em;
      border-bottom: 1px solid var(--border);
      font-weight: 600;
    }

    .process-table td {
      padding: 20px 16px;
      border-bottom: 1px solid var(--border);
      vertical-align: top;
      color: var(--text);
      line-height: 1.5;
    }

    .process-table .step-num {
      font-family: var(--serif);
      font-size: 32px;
      display: block;
      margin-bottom: 6px;
      line-height: 1;
    }

    .process-table .step-title {
      font-weight: 500;
      font-size: 16px;
      line-height: 1.3;
    }

    /* INVESTMENT */
    .investment-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 16px;
    }

    .invest-card {
      border: none;
      border-radius: 14px;
      padding: 32px 28px;
      background: rgba(255, 255, 255, 0.04);
      width: min(100%, 700px);
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .price-row {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 18px;
      align-items: center;
      padding: 16px 0;
      border-bottom: 1px solid var(--border);
    }

    .price-row:last-child {
      border-bottom: none;
    }

    .price-row--notes {
      grid-template-columns: 1fr 1fr;
      align-items: flex-start;
    }

    .price-label {
      font-family: var(--serif);
      font-size: 20px;
      color: #ffffff;
      font-weight: 500;
      line-height: 1.2;
    }

    .price-val {
      display: inline-flex;
      flex-direction: row;
      align-items: center;
      gap: 8px;
      background: transparent;
      flex-wrap: wrap;
    }

    .price-plan {
      font-family: var(--sans);
      font-size: 16px;
      font-weight: 600;
      padding: 6px 12px;
      border-radius: 6px;
      background: rgba(255, 255, 255, 0.07);
      color: var(--text);
      box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.15);
      white-space: nowrap;
    }

    .price-amount {
      font-family: var(--sans);
      font-size: 16px;
      font-weight: 700;
      background: var(--accent);
      color: #000000 !important;
      padding: 6px 12px;
      border-radius: 6px;
      white-space: nowrap;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .price-amount:empty {
      display: none;
    }

    .price-note {
      font-size: 15px;
      line-height: 1.5;
      text-align: right;
      color: #e2d9cb;
      font-weight: 400;
    }

    .invest-notes {
      width: min(100%, 700px);
      margin: 32px auto 0;
      display: flex;
      flex-direction: column;
      gap: 20px;
      font-size: 15px;
      line-height: 1.75;
      color: var(--text);
    }

    .invest-notes strong {
      color: var(--accent);
      font-weight: 600;
    }

    .invest-notes p {
      margin: 0;
    }

    /* SIGNATURE */
    .signature-block {
      margin-top: 100px;
      border-top: 2px solid black;
      padding-top: 48px;
    }

    .sig-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 40px;
      margin-bottom: 32px;
    }

    .input-group {
      margin-bottom: 32px;
    }

    .input-group label {
      display: block;
      font-size: 12px;
      text-transform: uppercase;
      margin-bottom: 12px;
      color: #666;
    }

    .input-line {
      border-bottom: 1px solid #999;
      height: 36px;
    }

    .sig-pad-wrapper {
      margin-top: 32px;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    #signature-pad {
      border: 1px solid var(--border);
      background: rgba(0, 0, 0, 0.3);
      border-radius: 8px;
      width: 100%;
      height: 180px;
      touch-action: none;
    }

    .sig-actions {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      margin-top: 16px;
    }

    /* Primary Actions */
    .sig-actions button {
      border: none;
      padding: 10px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      transition: all 0.2s ease;
    }

    /* Standard button (Clear) */
    .btn-standard {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text);
    }

    .btn-standard:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    /* Agree Button (Alternative Primary) */
    .btn-agree {
      background: transparent;
      border: 1px solid var(--accent);
      color: var(--accent);
    }

    .btn-agree:hover {
      background: var(--accent);
      color: #000;
    }

    .btn-agree.active {
      background: var(--accent);
      color: #000;
      cursor: default;
    }

    /* Download PDF (Primary CTA) */
    .btn-primary {
      background: var(--text);
      color: #000;
      margin-left: auto;
      /* Push to right */
    }

    .btn-primary:hover {
      background: #fff;
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
    }

    .sig-status {
      margin-top: 8px;
      font-size: 13px;
      color: var(--muted);
      min-height: 20px;
    }

    /* Stamped State (for "I Agree") */
    .signature-pad-container {
      position: relative;
    }

    .agreement-stamp {
      display: none;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) rotate(-5deg);
      border: 3px solid var(--accent);
      color: var(--accent);
      padding: 10px 20px;
      font-family: var(--serif);
      font-size: 24px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      pointer-events: none;
      background: rgba(11, 9, 8, 0.9);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
    }

    .agreement-stamp.visible {
      display: block;
    }

    /* RESPONSIVE - TABLET */
    @media (min-width: 769px) and (max-width: 1024px) {
      body {
        padding: 32px 24px;
      }

      .page {
        padding: 32px 36px 48px;
      }

      h1 {
        font-size: 54px;
      }

      h2 {
        font-size: 48px;
        margin-bottom: 32px;
      }

      .hero-img {
        height: 280px;
        margin-bottom: 56px;
      }

      section {
        margin-bottom: 48px;
      }

      .grid-2 {
        gap: 20px;
      }

      .num {
        font-size: 36px;
      }

      .invest-card {
        padding: 24px;
      }

      .price-label {
        font-size: 18px;
      }

      .price-val {
        font-size: 17px;
      }
    }

    /* RESPONSIVE - MOBILE */
    @media (max-width: 768px) {
      body {
        padding: 0;
        background: var(--bg-secondary);
        /* Match page bg */
      }

      .page {
        padding: 24px 20px 60px;
        width: 100%;
        max-width: 100%;
        border: none;
        border-radius: 0;
        box-shadow: none;
        margin: 0;
      }

      .hero-img {
        margin: 0 -20px 52px;
        /* Access full width relative to page padding */
        width: calc(100% + 40px);
        border-radius: 0;
      }

      header {
        gap: 10px;
      }

      .topbar {
        display: grid;
        grid-template-columns: 1fr;
        justify-items: center;
        align-items: center;
        text-align: center;
        gap: 6px;
      }

      .meta {
        justify-self: center;
        text-align: center;
      }

      .logo img {
        height: 38px;
      }

      h1 {
        font-size: 36px;
        line-height: 1.1;
        padding: 6px 12px;
        align-self: center;
        text-align: center;
        word-wrap: break-word;
        max-width: 100%;
      }

      .subtitle {
        font-size: 16px;
        padding: 6px 10px;
        align-self: center;
        text-align: center;
      }

      h2 {
        font-size: 32px;
        margin-bottom: 20px;
        line-height: 1.1;
      }

      section {
        margin-bottom: 40px;
      }

      .hero-img {
        height: 200px;
        margin-bottom: 40px;
      }

      .grid-2 {
        grid-template-columns: 1fr;
        gap: 18px;
      }

      .process-table,
      .process-table tbody,
      .process-table tr,
      .process-table td {
        display: block;
        width: 100%;
      }

      .process-table thead {
        display: none;
      }

      .process-table tr {
        margin-bottom: 24px;
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 20px;
        background: rgba(255, 255, 255, 0.03);
      }

      .process-table td {
        border-bottom: none;
        padding: 0 0 12px;
      }

      .process-table td:last-child {
        padding-bottom: 0;
      }

      .process-table .step-num {
        font-size: 24px;
        margin-bottom: 4px;
        color: var(--accent);
      }

      .process-table .step-title {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 8px;
        display: block;
      }

      .invest-card {
        width: 100%;
        padding: 20px 18px;
      }

      .price-row {
        grid-template-columns: 1fr;
      }

      .price-row--notes {
        grid-template-columns: 1fr;
      }

      .price-note {
        text-align: left;
      }

      .investment-section {
        gap: 12px;
      }

      .invest-notes {
        width: 100%;
        margin-top: 24px;
        gap: 14px;
        font-size: 14px;
      }

      .sig-grid {
        grid-template-columns: 1fr;
        gap: 18px;
      }

      #signature-pad {
        height: 160px;
      }

      .sig-actions {
        flex-direction: column;
        align-items: stretch;
      }

      .sig-actions button {
        width: 100%;
        text-align: center;
      }
    }

    /* UTILS */
    .highlight {
      background: var(--accent);
      padding: 0 4px;
    }

    /* PRINT / PDF EXPORT */
    @media print {
      @page {
        margin: 0;
        size: auto;
      }

      html,
      body {
        width: 100%;
        height: 100%;
        margin: 0 !important;
        padding: 0 !important;
        background-color: #0f0a09 !important;
        /* Force dark bg */
        print-color-adjust: exact !important;
      }

      .page {
        margin: 0 !important;
        border: none !important;
        box-shadow: none !important;
        width: 100% !important;
        max-width: 100% !important;
        padding: 40px !important;
        background-color: #0f0a09 !important;
      }

      .sig-actions,
      .sig-status,
      #sig-status {
        display: none !important;
      }

      section,
      .invest-card {
        page-break-inside: avoid;
      }
    }
  </style>
</head>

<body>
  <div class="page">
    <!-- COVER -->
    <header>
      <div class="topbar">
        <div class="logo"><img src="{{LOGO_DATA_URI}}" alt="Logo"></div>
      </div>
      <div class="title-block">
        <h1>Website proposal for {{CLIENT_NAME}}</h1>
        <div class="subtitle">Prepared by {{PREPARED_BY}} — {{DATE}}</div>
      </div>
      <div class="meta meta-strip">WEBSITE PROPOSAL | {{CLIENT_NAME}} | {{DATE}}</div>
    </header>

    <div class="hero-img"></div>

    <!-- YOUR GOALS -->
    <section class="goals-section">
      <h2><strong>YOUR</strong> goals.</h2>
      <div class="grid-2">
        {{GOALS_HTML}}
      </div>
    </section>

    <!-- PROBLEM FACTORS -->
    <section class="problem-section">
      <h2><strong>Problem</strong> factors getting in the way.</h2>
      <p class="problem-intro">{{PROBLEM}}</p>
      <div class="problem-divider"></div>
      <div class="problem-grid">
        <div class="problem-card">
          <span class="problem-num">01</span>
          <p class="problem-body">{{PROBLEM_POINT_1}}</p>
        </div>
        <div class="problem-card">
          <span class="problem-num">02</span>
          <p class="problem-body">{{PROBLEM_POINT_2}}</p>
        </div>
        <div class="problem-card">
          <span class="problem-num">03</span>
          <p class="problem-body">{{PROBLEM_POINT_3}}</p>
        </div>
        <div class="problem-card">
          <span class="problem-num">04</span>
          <p class="problem-body">{{PROBLEM_POINT_4}}</p>
        </div>
      </div>
    </section>

    <!-- MY PITCH -->
    <section class="solution-section">
      <h2><strong>My</strong> pitch &amp; proposed solutions.</h2>
      <p class="solution-summary">{{SOLUTION}}</p>
      <p class="solution-context">
        Solving these needs is straightforward; we've shipped fast, modern sites that generate leads like this many times
        before. In practice, we combine <span>modern design</span>, <span>clean implementation</span>, and simple
        <span>lead capture</span>. Here's how that rolls out for {{CLIENT_NAME}}:
      </p>
      <div class="solution-divider"></div>
      <div class="solution-grid">
        <div class="solution-card">
          <span class="num">01</span>
          <p>{{SOLUTION_POINT_1}}</p>
        </div>
        <div class="solution-card">
          <span class="num">02</span>
          <p>{{SOLUTION_POINT_2}}</p>
        </div>
        <div class="solution-card">
          <span class="num">03</span>
          <p>{{SOLUTION_POINT_3}}</p>
        </div>
        <div class="solution-card">
          <span class="num">04</span>
          <p>{{SOLUTION_POINT_4}}</p>
        </div>
      </div>
      <div class="solution-meta">
        <span>Estimated timeline</span>
        <span>{{TIMELINE}}</span>
      </div>
    </section>

    <section>
      <h2><strong>How</strong> to work with us.</h2>
      <p class="how-intro">
        We keep the process simple and transparent. You’ll always know what’s in progress, what’s blocked, and what’s
        shipping next.
      </p>
      <div class="grid-2">
        <div class="item">
          <span class="num">01</span>
          <p class="desc">All requests and feedback live in Trello so nothing gets lost.</p>
        </div>
        <div class="item">
          <span class="num">02</span>
          <p class="desc">We ship in small iterations and ask clarifying questions early.</p>
        </div>
        <div class="item">
          <span class="num">03</span>
          <p class="desc">You’ll get clear review checkpoints (design, then build, then polish).</p>
        </div>
        <div class="item">
          <span class="num">04</span>
          <p class="desc">Fast communication: reply in-thread, and we’ll keep momentum moving.</p>
        </div>
      </div>
    </section>

    <!-- TERMS -->
    <section class="investment-section">
      <h2><strong>TERMS</strong> &amp; monthly subscription.</h2>
      <div class="invest-card">
        <div class="price-row">
          <span class="price-label">Monthly Subscription</span>
          <span class="price-val">
            <span class="price-plan">{{INVESTMENT_PLAN}}</span>
            <span class="price-amount">{{INVESTMENT_PRICE}}</span>
          </span>
        </div>
        <div class="price-row price-row--notes">
          <span class="price-label">Bank Details</span>
          <span class="price-note">Scotiabank<br>Name: Addis Ellis<br>Account: 90175 000853932<br>Transit: 90175</span>
        </div>
        <div class="price-row">
          <span class="price-label">{{MIN_TERM_LABEL}}</span>
          <span class="price-val">
            <span class="price-plan">{{MIN_TERM_VALUE}}</span>
          </span>
        </div>
      </div>
      <div class="invest-notes">
        <p>{{INVEST_NOTE_1}}</p>
        <p>{{INVEST_NOTE_2}}</p>
        <p>{{INVEST_NOTE_3}}</p>
        <p>{{INVEST_NOTE_4}}</p>
      </div>
    </section>

    <!-- SIGNATURE -->
    <section class="signature-block">
      <p style="margin-bottom: 20px;">Sign below to accept this proposal and begin our partnership.</p>
      <div class="sig-grid">
        <div class="input-group">
          <label>Client Name</label>
          <div class="input-line"></div>
        </div>
        <div class="input-group">
          <label>Date</label>
          <div class="input-line"></div>
        </div>
      </div>
      <div class="sig-pad-wrapper">
        <label style="font-size:12px; text-transform:uppercase; color:#666;">Signature</label>

        <div class="signature-pad-container">
          <canvas id="signature-pad"></canvas>
          <div class="agreement-stamp" id="agreement-stamp">AGREED via Digital Consent</div>
        </div>

        <div class="sig-actions">
          <button type="button" class="btn-standard" id="sig-clear">Clear / Reset</button>
          <button type="button" class="btn-agree" id="sig-agree">I Agree (No Drawing)</button>
          <button type="button" class="btn-primary" id="sig-download-pdf">Download Signed PDF</button>
        </div>
        <div style="text-align:center; font-size:11px; color:#555; margin-top:8px; display:none;" id="print-hint">
          (If download fails, use Browser Menu &rarr; Share &rarr; Print)
        </div>
        <script>
          // Show hint only if likely mobile or known tricky environment? Or always?
          // Always showing is safer for now.
          document.getElementById('print-hint').style.display = 'block';
        </script>

        <div class="sig-status" id="sig-status"></div>
      </div>
    </section>

    <div class="meta" style="margin-top: 40px; border: none;">
      Prepared by {{PREPARED_BY}} · {{DATE}}
    </div>
  </div>

  <script>
    (function () {
      const canvas = document.getElementById('signature-pad');
      if (!canvas) return;

      const ctx = canvas.getContext('2d');
      const clearBtn = document.getElementById('sig-clear');
      const agreeBtn = document.getElementById('sig-agree');
      const stamp = document.getElementById('agreement-stamp');
      const status = document.getElementById('sig-status');

      function resizeCanvas() {
        const ratio = window.devicePixelRatio || 1;
        canvas.width = canvas.clientWidth * ratio;
        canvas.height = canvas.clientHeight * ratio;
        ctx.scale(ratio, ratio);
        ctx.lineWidth = 2.5;
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';
        ctx.strokeStyle = '#f5e6c9';
      }
      resizeCanvas();
      window.addEventListener('resize', resizeCanvas);

      let drawing = false;
      let points = [];
      let isAgreed = false;

      function getPos(e) {
        const rect = canvas.getBoundingClientRect();
        if (e.touches && e.touches.length > 0) {
          return { x: e.touches[0].clientX - rect.left, y: e.touches[0].clientY - rect.top };
        }
        return { x: e.clientX - rect.left, y: e.clientY - rect.top };
      }

      function start(e) {
        if (isAgreed) return;
        drawing = true;
        points = [getPos(e)];
        status.textContent = 'Signing...';
      }

      function move(e) {
        if (!drawing) return;
        const pos = getPos(e);
        points.push(pos);

        if (points.length < 3) return;

        ctx.beginPath();
        ctx.moveTo(points[0].x, points[0].y);

        for (let i = 1; i < points.length - 1; i++) {
          const midX = (points[i].x + points[i + 1].x) / 2;
          const midY = (points[i].y + points[i + 1].y) / 2;
          ctx.quadraticCurveTo(points[i].x, points[i].y, midX, midY);
        }

        ctx.stroke();

        if (points.length > 3) {
          points = points.slice(-3);
        }
      }

      function end() {
        if (drawing && points.length > 0) {
          if (points.length >= 2) {
            ctx.beginPath();
            ctx.moveTo(points[points.length - 2].x, points[points.length - 2].y);
            ctx.lineTo(points[points.length - 1].x, points[points.length - 1].y);
            ctx.stroke();
          }
          status.textContent = 'Signature recorded.';
        }
        drawing = false;
        points = [];
      }

      canvas.addEventListener('mousedown', start);
      canvas.addEventListener('mousemove', move);
      canvas.addEventListener('mouseup', end);
      canvas.addEventListener('mouseleave', end);
      canvas.addEventListener('touchstart', (e) => { e.preventDefault(); start(e); });
      canvas.addEventListener('touchmove', (e) => { e.preventDefault(); move(e); });
      canvas.addEventListener('touchend', end);

      clearBtn?.addEventListener('click', () => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        stamp.classList.remove('visible');
        agreeBtn.classList.remove('active');
        isAgreed = false;
        points = [];
        status.textContent = 'Cleared. Please sign or click "I Agree".';
      });

      agreeBtn?.addEventListener('click', () => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        stamp.classList.add('visible');
        agreeBtn.classList.add('active');
        isAgreed = true;
        status.textContent = 'Digital agreement recorded.';
      });

      document.getElementById('sig-download-pdf').addEventListener('click', () => {
        try {
          window.print();
        } catch (err) {
          alert("Could not open print dialog automatically. Please select 'Print' or 'Share > Print' from your browser menu.");
        }
      });
    })();
  </script>
</body>

</html>